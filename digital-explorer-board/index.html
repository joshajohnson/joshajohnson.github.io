<!DOCTYPE html><html lang="en" data-mode="dark" ><head><meta http-equiv="Content-Type" content="text/html; charset=UTF-8"><meta name="theme-color" media="(prefers-color-scheme: light)" content="#f7f7f7"><meta name="theme-color" media="(prefers-color-scheme: dark)" content="#1b1b1e"><meta name="apple-mobile-web-app-capable" content="yes"><meta name="apple-mobile-web-app-status-bar-style" content="black-translucent"><meta name="viewport" content="width=device-width, user-scalable=no initial-scale=1, shrink-to-fit=no, viewport-fit=cover" ><meta name="generator" content="Jekyll v4.3.2" /><meta property="og:title" content="Digital Explorer Board" /><meta property="og:locale" content="en" /><meta name="description" content="On your bPod, you’ll find a tools menu which provides a way to interface with a number of common embedded protocols. The digital explorer board in combination with a logic analyser provides a way to see what these signals look like, and hopefully provide a greater understanding of the protocols used in modern electronics." /><meta property="og:description" content="On your bPod, you’ll find a tools menu which provides a way to interface with a number of common embedded protocols. The digital explorer board in combination with a logic analyser provides a way to see what these signals look like, and hopefully provide a greater understanding of the protocols used in modern electronics." /><link rel="canonical" href="https://joshajohnson.github.io/digital-explorer-board/" /><meta property="og:url" content="https://joshajohnson.github.io/digital-explorer-board/" /><meta property="og:site_name" content="Josh Johnson" /><meta property="og:type" content="article" /><meta property="article:published_time" content="2023-08-31T20:00:15+10:00" /><meta name="twitter:card" content="summary" /><meta property="twitter:title" content="Digital Explorer Board" /><meta name="twitter:site" content="@_joshajohnson" /> <script type="application/ld+json"> {"@context":"https://schema.org","@type":"BlogPosting","dateModified":"2023-09-24T20:35:47+10:00","datePublished":"2023-08-31T20:00:15+10:00","description":"On your bPod, you’ll find a tools menu which provides a way to interface with a number of common embedded protocols. The digital explorer board in combination with a logic analyser provides a way to see what these signals look like, and hopefully provide a greater understanding of the protocols used in modern electronics.","headline":"Digital Explorer Board","mainEntityOfPage":{"@type":"WebPage","@id":"https://joshajohnson.github.io/digital-explorer-board/"},"url":"https://joshajohnson.github.io/digital-explorer-board/"}</script><title>Digital Explorer Board | Josh Johnson</title><link rel="apple-touch-icon" sizes="180x180" href="/assets/img/favicons/apple-touch-icon.png"><link rel="icon" type="image/png" sizes="32x32" href="/assets/img/favicons/favicon-32x32.png"><link rel="icon" type="image/png" sizes="16x16" href="/assets/img/favicons/favicon-16x16.png"><link rel="manifest" href="/assets/img/favicons/site.webmanifest"><link rel="shortcut icon" href="/assets/img/favicons/favicon.ico"><meta name="apple-mobile-web-app-title" content="Josh Johnson"><meta name="application-name" content="Josh Johnson"><meta name="msapplication-TileColor" content="#da532c"><meta name="msapplication-config" content="/assets/img/favicons/browserconfig.xml"><meta name="theme-color" content="#ffffff"><link rel="preconnect" href="https://fonts.googleapis.com" ><link rel="dns-prefetch" href="https://fonts.googleapis.com" ><link rel="preconnect" href="https://fonts.gstatic.com" crossorigin><link rel="dns-prefetch" href="https://fonts.gstatic.com" crossorigin><link rel="preconnect" href="https://fonts.googleapis.com" ><link rel="dns-prefetch" href="https://fonts.googleapis.com" ><link rel="preconnect" href="https://cdn.jsdelivr.net" ><link rel="dns-prefetch" href="https://cdn.jsdelivr.net" ><link rel="stylesheet" href="https://fonts.googleapis.com/css2?family=Lato&family=Source+Sans+Pro:wght@400;600;700;900&display=swap"><link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/bootstrap@4/dist/css/bootstrap.min.css"><link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/@fortawesome/fontawesome-free@5.11.2/css/all.min.css"><link rel="stylesheet" href="/assets/css/style.css"><link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/tocbot@4.20.1/dist/tocbot.min.css"><link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/magnific-popup@1/dist/magnific-popup.min.css"> <script src="https://cdn.jsdelivr.net/npm/jquery@3/dist/jquery.min.js"></script><body data-topbar-visible="true"><div id="sidebar" class="d-flex flex-column align-items-end"><div class="profile-wrapper text-center"><div id="avatar"> <a href="/" class="mx-auto"> <img src="/assets/img/josh-mugshot.jpg" alt="avatar" onerror="this.style.display='none'"> </a></div><div class="site-title"> <a href="/">Josh Johnson</a></div><div class="site-subtitle font-italic">Projects from my 5 til 9</div></div><ul class="w-100"><li class="nav-item"> <a href="/" class="nav-link"> <i class="fa-fw fas fa-home ml-xl-3 mr-xl-3 unloaded"></i> <span>HOME</span> </a><li class="nav-item"> <a href="/products/" class="nav-link"> <i class="fa-fw fas fa-plug ml-xl-3 mr-xl-3 unloaded"></i> <span>PRODUCTS</span> </a><li class="nav-item"> <a href="/projects/" class="nav-link"> <i class="fa-fw fas fa-hammer ml-xl-3 mr-xl-3 unloaded"></i> <span>PROJECTS</span> </a><li class="nav-item"> <a href="/about/" class="nav-link"> <i class="fa-fw fas fa-info-circle ml-xl-3 mr-xl-3 unloaded"></i> <span>ABOUT</span> </a></ul><div class="sidebar-bottom mt-auto d-flex flex-wrap justify-content-center align-items-center"> <a href="https://github.com/joshajohnson" aria-label="github" target="_blank" rel="noopener noreferrer"> <i class="fab fa-github"></i> </a> <a href="https://twitter.com/_joshajohnson" aria-label="twitter" target="_blank" rel="noopener noreferrer"> <i class="fab fa-twitter"></i> </a> <a href="javascript:location.href = 'mailto:' + ['contact','joshajohnson.com'].join('@')" aria-label="email" > <i class="fas fa-envelope"></i> </a></div></div><div id="topbar-wrapper"><div id="topbar" class="container d-flex align-items-center justify-content-between h-100 pl-3 pr-3 pl-md-4 pr-md-4"> <span id="breadcrumb"> <span> <a href="/"> Home </a> </span> <span>Digital Explorer Board</span> </span> <i id="sidebar-trigger" class="fas fa-bars fa-fw"></i><div id="topbar-title"> Post</div><i id="search-trigger" class="fas fa-search fa-fw"></i> <span id="search-wrapper" class="align-items-center"> <i class="fas fa-search fa-fw"></i> <input class="form-control" id="search-input" type="search" aria-label="search" autocomplete="off" placeholder="Search..."> </span> <span id="search-cancel" >Cancel</span></div></div><div id="main-wrapper" class="d-flex justify-content-center"><div id="main" class="container pl-xl-4 pr-xl-4"><div class="row"><div id="core-wrapper" class="col-12 col-lg-11 col-xl-9 pr-xl-4"><div class="post pl-1 pr-1 pl-md-2 pr-md-2"><h1 data-toc-skip>Digital Explorer Board</h1><div class="post-meta text-muted"> <span> Posted <em class="" data-ts="1693476015" data-df="ll" data-toggle="tooltip" data-placement="bottom"> Aug 31, 2023 </em> </span> <span> Updated <em class="" data-ts="1695551747" data-df="ll" data-toggle="tooltip" data-placement="bottom"> Sep 24, 2023 </em> </span><div class="d-flex justify-content-between"> <span> By <em> <a href="https://twitter.com/_joshajohnson">Josh Johnson</a> </em> </span><div> <span class="readtime" data-toggle="tooltip" data-placement="bottom" title="2164 words"> <em>12 min</em> read</span></div></div></div><div class="post-content"><p>On your bPod, you’ll find a tools menu which provides a way to interface with a number of common embedded protocols. The <a href="https://github.com/joshajohnson/digital-explorer">digital explorer board</a> in combination with a logic analyser provides a way to see what these signals look like, and hopefully provide a greater understanding of the protocols used in modern electronics.</p><p><a href="/assets/2023-09-01-digital-explorer-board/all_connected.JPG" class="popup img-link "><img data-src="/assets/2023-09-01-digital-explorer-board/all_connected.JPG" alt="conneted to la and bpod" class="lazyload" data-proofer-ignore></a></p><h2 id="setup"><span class="mr-2">Setup</span><a href="#setup" class="anchor text-muted"><i class="fas fa-hashtag"></i></a></h2><h3 id="connecting-the-digital-explorer-board"><span class="mr-2">Connecting the Digital Explorer Board</span><a href="#connecting-the-digital-explorer-board" class="anchor text-muted"><i class="fas fa-hashtag"></i></a></h3><p>Connecting the Digital Explorer Board is as simple as plugging it into a 5V power source, preferably your laptop so you can modify the code. Once connected to your laptop, it’ll show up as a mass storage device <code class="language-plaintext highlighter-rouge">CIRCUITPY</code> and by opening the <code class="language-plaintext highlighter-rouge">code.py</code> file found within you can modify the code running on it. The code is all written in Python and when saved is automatically run - all on device!</p><p>To see the output from your code, use a serial monitor tool (e.g. Putty for Windows, screen for Linux) to connect to the <code class="language-plaintext highlighter-rouge">COM</code> or <code class="language-plaintext highlighter-rouge">dev/ttyACM</code> port that enumerates when the device is plugged in. For more info, check out the <a href="https://learn.adafruit.com/welcome-to-circuitpython">CircuitPython docs</a>.</p><h3 id="connecting-the-logic-analyser"><span class="mr-2">Connecting the Logic Analyser</span><a href="#connecting-the-logic-analyser" class="anchor text-muted"><i class="fas fa-hashtag"></i></a></h3><p>Before connecting the logic analyser, we need to install <a href="https://sigrok.org/wiki/Downloads">Pulseview</a>, an open source logic analyser tool.</p><p>Sparkfun has a <a href="https://learn.sparkfun.com/tutorials/using-the-usb-logic-analyzer-with-sigrok-pulseview/all">great document</a> on how to setup the software to work with your logic analyser.</p><p>To connect the logic analyser to the Digital Explorer Board, we need to plug in the interceptor board, which acts as a passthrough between bPod and the Digital Explorer Board, whilst providing a pinout to plug the logic analyser into. When connecting the logic analyser, ensure the USB port is pointing in the same direction as the port on the Digital Explorer Board, as otherwise smoke may escape from your PC!</p><p><strong>Ensure you set the sample rate to at least 1MHz, otherwise the sample speed will be too slow to detect some of the signals!</strong></p><h3 id="connecting-bpod"><span class="mr-2">Connecting bPod</span><a href="#connecting-bpod" class="anchor text-muted"><i class="fas fa-hashtag"></i></a></h3><p>bPod plugs into the interceptor board upside down, as shown in the below image. You’ll notice the interceptor board has one fewer pin than bPod, this is to prevent smoke if plugged in the wrong way.</p><p><a href="/assets/2023-09-01-digital-explorer-board/bpod_mate.JPG" class="popup img-link "><img data-src="/assets/2023-09-01-digital-explorer-board/bpod_mate.JPG" alt="bpod conneted to la" class="lazyload" data-proofer-ignore></a></p><p>For reasons I can’t tell you (cough cough CTF) plugging bPod into the board will cause I2C issues with the MCP23017, so you’ll need to comment that code out (or put the RP2040 into bootloader by holding the BOOT button on the Pico and pressing the reset button) depending on what you want to do.</p><h2 id="tour-of-the-digital-explorer-board"><span class="mr-2">Tour of the Digital Explorer Board</span><a href="#tour-of-the-digital-explorer-board" class="anchor text-muted"><i class="fas fa-hashtag"></i></a></h2><p>The digital explorer board contains a number of common ICs found in modern electronics. They are summarised below:</p><p><a href="/assets/2023-09-01-digital-explorer-board/board_render.png" class="popup img-link "><img data-src="/assets/2023-09-01-digital-explorer-board/board_render.png" alt="render of bpod" class="lazyload" data-proofer-ignore></a></p><div class="table-wrapper"><table><thead><tr><th>Part Number<th>Type<th>Comms Protocol<th>Datasheet<th> <tbody><tr><td>74HC595<td>8-Bit Shift Registers With 3-State Output Registers<td>SPI<td>https://www.ti.com/lit/ds/symlink/sn74hc595.pdf<td> <tr><td>74HC165<td>8-Bit Parallel-Load Shift Registers<td>SPI<td>https://www.ti.com/lit/ds/symlink/sn74hc165.pdf<td> <tr><td>MCP23017<td>16-Bit I/O Expander with Serial Interface<td>I2C<td>https://ww1.microchip.com/downloads/aemDocuments/documents/APID/ProductDocuments/DataSheets/MCP23017-Data-Sheet-DS20001952.pdf<td> <tr><td>LSM6DS3<td>Inertial Module: 3D Accelerometer and 3D Gyroscope<td>I2C<td>https://www.st.com/resource/en/datasheet/lsm6ds3tr-c.pdf<td> <tr><td>WS2812B<td>Addressable LED<td>Proprietary<td>https://cdn-shop.adafruit.com/datasheets/WS2812B.pdf<td> </table></div><p>The board also has a number of DIP switches and LEDs to interact with:</p><ul><li><strong>MCP ADDR</strong> is used to set the I2C address of the MCP23017 from 0x20 to 0x27.<li><strong>MCP IO</strong> is connected to 4 input pins on the MCP23017, and the state of these DIP switches is mirrored to the LEDs below.<li><strong>SHIFT REG IO</strong> is connected to the 74HC165, and the corresponding LEDs are connected to the 74HC595.<li><strong>WS2812 LEDs</strong> are located at the top of the board, and display pretty colours. The data signal going into each LED is broken out below the bPod connector.</ul><p>The board also breaks out a UART from the RP2040 the bPod connector. For more info on how this is all connected <a href="https://github.com/joshajohnson/digital-explorer/blob/main/hardware/0.1/demo_pcb.pdf">check out the schematic</a>.</p><h2 id="what-is-spi--i2c--uart"><span class="mr-2">What is SPI / I2C / UART?</span><a href="#what-is-spi--i2c--uart" class="anchor text-muted"><i class="fas fa-hashtag"></i></a></h2><p>Much like on the digital explorer board, a typical printed circuit board assembly will consist of a microcontroller as the brains of the operation, and a number of peripherals to perform specific tasks which the microcontroller cannot. To interface between the micro and peripheral, a number of standardised communication interfaces exist to allow part from varying manufactures to exist together.</p><p>These days most microcontrollers operate at 3.3V, and as such a logic <code class="language-plaintext highlighter-rouge">1</code> is when the voltage at the pin is 3.3V, and a logic <code class="language-plaintext highlighter-rouge">0</code> when the voltage is zero.</p><h3 id="spi---serial-peripheral-interface"><span class="mr-2">SPI - Serial Peripheral Interface</span><a href="#spi---serial-peripheral-interface" class="anchor text-muted"><i class="fas fa-hashtag"></i></a></h3><p>SPI is one of the most common interfaces, and is typically configured in a controller / peripheral (master / slave) configuration with the following pins:</p><ul><li><strong>SCLK</strong> Serial Clock (driven from controller)<li><strong>COPI</strong> Controller Out Peripheral In (data output from controller)<li><strong>CIPO</strong> Peripheral Out Controller In (data output from peripheral)<li><strong>nCS</strong> Chip Select (active low signal to begin transmission)</ul><p>SPI is a simple interface which allows high data throughput, making it a great option for both simple devices like shift registers, all the way to SD cards and TFT displays.</p><p>Sparkfun has a <a href="https://learn.sparkfun.com/tutorials/serial-peripheral-interface-spi/all">great document</a> going into all the details about SPI.</p><h3 id="i2c---inter-integrated-circuit"><span class="mr-2">I2C - Inter-Integrated Circuit</span><a href="#i2c---inter-integrated-circuit" class="anchor text-muted"><i class="fas fa-hashtag"></i></a></h3><p>I2C is also another common interface, and is unique in that you can connect 127 devices together using only two pins.</p><ul><li><strong>SDA</strong> Serial Data<li><strong>SCL</strong> Serial Clock</ul><p>Due to having multiple devices on a shared bus each device has an address, and the controller needs to send the device address before sending data or a command. This greatly reduces the data throughput for a device on I2C, but for slow changing signals (e.g. LEDs, temperature) it’s a great solution as it does not require a high pin count from the microcontroller.</p><p>Once again, Sparkfun <a href="https://learn.sparkfun.com/tutorials/i2c">goes into great detail</a> about the inner workings of I2C.</p><h3 id="uart---universal-asynchronous-receiver-transmitter"><span class="mr-2">UART - Universal Asynchronous Receiver-Transmitter</span><a href="#uart---universal-asynchronous-receiver-transmitter" class="anchor text-muted"><i class="fas fa-hashtag"></i></a></h3><p>If you’ve ever plugged in a cable and opened a terminal to an embedded device, you were most likely using UART to communicate with the device. It’s commonly used for communication between two microcontrollers, or between human and microcontroller.</p><ul><li><strong>TX</strong> Transmit (leaving micro)<li><strong>RX</strong> Receive (entering micro)</ul><p>As UART is asynchronous, both devices need to be configured to the correct baudrate (bits per second) along with length, stop, and parity bits. There are two common speeds (9600 and 115200) and the so called “8N1” (8 bits, no parity, one stop) configuration which are used by most devices.</p><p>You can probably guess what <a href="https://learn.sparkfun.com/tutorials/serial-communication">this link is</a> if you’d like to learn more about UART.</p><h3 id="ws2812b---individually-addressable-leds"><span class="mr-2">WS2812B - Individually Addressable LEDs</span><a href="#ws2812b---individually-addressable-leds" class="anchor text-muted"><i class="fas fa-hashtag"></i></a></h3><p>Whilst WS2812Bs are not a communication protocol, they are a LED used in many hobby projects as you can have an infinite chain of RGB LEDs controlled by a single microcontroller pin.</p><p>It uses a single pin which toggles between high and low, with the time high / time low indicating a 1 or a 0. These 1 and 0’s are formed into a packet containing the R/G/B value for each LED, and sent down the chain to make your PCBs look pretty.</p><p>Page 4 of <a href="https://cdn-shop.adafruit.com/datasheets/WS2812B.pdf">the datasheet</a> goes into more detail about this protocol.</p><h2 id="what-does-the-board-do"><span class="mr-2">What Does the Board Do?</span><a href="#what-does-the-board-do" class="anchor text-muted"><i class="fas fa-hashtag"></i></a></h2><p>To demonstrate the above discussed protocols, after configuring the peripherals the the code on the RP2040 talks to each device in a big super loop, enabling you to see how changing the DIP switches / angle of the board impacts the messages being sent over the wires.</p><h3 id="reading-74hc165-shift-register-values"><span class="mr-2">Reading 74HC165 Shift Register Values</span><a href="#reading-74hc165-shift-register-values" class="anchor text-muted"><i class="fas fa-hashtag"></i></a></h3><p><strong>Do NOT have bPod connected for this demo</strong></p><p>With SPI, the below sequence of operation is used to read values.</p><ul><li>Assert chip select (normally low, but for the 74HC165 it’s active high)<li>Clock rising edge causes peripheral to shift out data<li>Controller reads data that was shifted out<li>Clock goes low<li>Do it all over again until all data has been read<li>Chip select released</ul><p>The below code shows how this is done on the RP2040</p><div class="language-python highlighter-rouge"><div class="code-header"> <span data-label-text="Python"><i class="fas fa-code small"></i></span> <button aria-label="copy" data-title-succeed="Copied!"><i class="far fa-clipboard"></i></button></div><div class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
2
3
4
5
6
7
8
9
10
11
12
13
14
15
16
17
18
19
20
21
22
23
24
25
26
</pre><td class="rouge-code"><pre><span class="c1"># Shift in 8 bits from 165 shift register
</span><span class="k">def</span> <span class="nf">shift_in</span><span class="p">():</span>
    <span class="c1"># Var to store read value in
</span>    <span class="n">readback</span> <span class="o">=</span> <span class="mi">0</span>

    <span class="c1"># Set chip select high to begin read
</span>    <span class="c1"># Normally chip select is active low, but it's not this time
</span>    <span class="c1"># I know the name is wrong, but I'm keeping it identical to the schematic / PCB
</span>    <span class="n">si_nlatch</span><span class="p">.</span><span class="n">value</span> <span class="o">=</span> <span class="bp">True</span>

    <span class="c1"># For the 8 inputs on the shift register, read them into the temp var
</span>    <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nf">range</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="mi">8</span><span class="p">):</span>
        <span class="c1"># Clock going high triggers shift out of next value
</span>        <span class="n">si_clk</span><span class="p">.</span><span class="n">value</span> <span class="o">=</span> <span class="bp">True</span>

        <span class="c1"># Bitwise or with 0 will set value if set on shift reg
</span>        <span class="n">readback</span> <span class="o">|=</span> <span class="p">(</span><span class="n">si_data</span><span class="p">.</span><span class="n">value</span><span class="p">)</span> <span class="o">&lt;&lt;</span> <span class="p">(</span><span class="mi">7</span><span class="o">-</span><span class="n">i</span><span class="p">)</span>
        
        <span class="c1"># Clock low so we can bring it high next time
</span>        <span class="n">si_clk</span><span class="p">.</span><span class="n">value</span> <span class="o">=</span> <span class="bp">False</span>

    <span class="c1"># Transaction over, return chip select to default state
</span>    <span class="n">si_nlatch</span><span class="p">.</span><span class="n">value</span> <span class="o">=</span> <span class="bp">False</span>

    <span class="c1"># Bitshifting to align values to MSB and invert as DIP switch is active low
</span>    <span class="nf">return </span><span class="p">(</span><span class="n">readback</span> <span class="o">&lt;&lt;</span> <span class="mi">3</span><span class="p">)</span> <span class="o">^</span> <span class="mh">0xFF</span>
</pre></table></code></div></div><p>The below trace from Pulseview shows bits 4 and 5 being high, with the rest low.</p><p><a href="/assets/2023-09-01-digital-explorer-board/shift_in.png" class="popup img-link "><img data-src="/assets/2023-09-01-digital-explorer-board/shift_in.png" alt="shift in reg" class="lazyload" data-proofer-ignore></a></p><h3 id="writing-74hc595-shift-register-values"><span class="mr-2">Writing 74HC595 Shift Register Values</span><a href="#writing-74hc595-shift-register-values" class="anchor text-muted"><i class="fas fa-hashtag"></i></a></h3><p><strong>Do NOT have bPod connected for this demo</strong></p><p>Writing the above read values out to the 74HC595 is more or less the same, with the change that the controller sets the data pin with the value before setting the clock high.</p><div class="language-python highlighter-rouge"><div class="code-header"> <span data-label-text="Python"><i class="fas fa-code small"></i></span> <button aria-label="copy" data-title-succeed="Copied!"><i class="far fa-clipboard"></i></button></div><div class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
2
3
4
5
6
7
8
9
10
11
12
13
14
15
16
17
18
19
20
21
22
23
24
25
26
</pre><td class="rouge-code"><pre><span class="c1"># Shift out 8 bit field to 595 shift register
</span><span class="k">def</span> <span class="nf">shift_out</span><span class="p">(</span><span class="n">bitfield</span><span class="p">):</span>
    <span class="c1"># Chip enable low to begin transaction
</span>    <span class="n">so_nlatch</span><span class="p">.</span><span class="n">value</span> <span class="o">=</span> <span class="bp">False</span>

    <span class="c1"># For each bit in the bitfield
</span>    <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nf">range</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="mi">8</span><span class="p">):</span>
        <span class="c1"># Set clock low
</span>        <span class="n">so_clk</span><span class="p">.</span><span class="n">value</span> <span class="o">=</span> <span class="bp">False</span>

        <span class="c1"># Check if bit is set and set data high / low accordingly
</span>        <span class="k">if</span> <span class="n">bitfield</span> <span class="o">&amp;</span> <span class="p">(</span><span class="mi">1</span> <span class="o">&lt;&lt;</span> <span class="n">i</span><span class="p">):</span>
            <span class="n">so_data</span><span class="p">.</span><span class="n">value</span> <span class="o">=</span> <span class="bp">True</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="n">so_data</span><span class="p">.</span><span class="n">value</span> <span class="o">=</span> <span class="bp">False</span>
        
        <span class="c1"># Clock going high shift the above set data in
</span>        <span class="n">so_clk</span><span class="p">.</span><span class="n">value</span> <span class="o">=</span> <span class="bp">True</span>

        <span class="c1"># Return data to zero value (not required, but easier for timing)
</span>        <span class="n">so_data</span><span class="p">.</span><span class="n">value</span> <span class="o">=</span> <span class="bp">False</span>

    <span class="c1"># Ensure clock is low when transaction finished
</span>    <span class="n">so_clk</span><span class="p">.</span><span class="n">value</span> <span class="o">=</span> <span class="bp">False</span>
    <span class="c1"># Chif enable high now transaction is done
</span>    <span class="n">so_nlatch</span><span class="p">.</span><span class="n">value</span> <span class="o">=</span> <span class="bp">True</span>
</pre></table></code></div></div><p>You can see the below has six outputs high and two low, which maps to the bitshifted value we got back from the 165 input read. The reason for the bits not lining up exactly is that the pins were swapped to make PCB routing easier, and the alignment is handled in software.</p><p><a href="/assets/2023-09-01-digital-explorer-board/shift_out.png" class="popup img-link "><img data-src="/assets/2023-09-01-digital-explorer-board/shift_out.png" alt="shift out reg" class="lazyload" data-proofer-ignore></a></p><h3 id="reading-and-writing-mcp32017-gpio-expander-values"><span class="mr-2">Reading and Writing MCP32017 GPIO Expander Values</span><a href="#reading-and-writing-mcp32017-gpio-expander-values" class="anchor text-muted"><i class="fas fa-hashtag"></i></a></h3><p><strong>Do NOT have bPod connected for this demo</strong></p><p>I2C takes more than a dozen lines of code to control, so I’ve used the CircuitPython busio library for this example. It does however make the demo a bit more complicated than I’d like due to how it handles the IO.</p><p>The logic trace shows the below.</p><ul><li>Setup Address Write to <code class="language-plaintext highlighter-rouge">0x20</code> (MCP Address)<li>Tell MCP we want to read read register <code class="language-plaintext highlighter-rouge">0x12</code><ul><li><code class="language-plaintext highlighter-rouge">0x12</code> is the GPIOA register, which stores the state for the IO pins</ul><li>Setup read to MCP<li>Read two bytes (<code class="language-plaintext highlighter-rouge">0x0C, 0x03</code>)<ul><li>It appears the default library reads both ports at once, as the second byte (addr <code class="language-plaintext highlighter-rouge">0x13</code> is for GPIOB)</ul><li>Setup write to MCP<li><p>Write two bytes at <code class="language-plaintext highlighter-rouge">0x12</code> (i.e. write the values out to the MCP)</p><li>Interspersed between all of this are ACKs and NAKs which are used to confirm the peripheral has received the instruction and will act upon it (or not!).</ul><p><a href="/assets/2023-09-01-digital-explorer-board/mcp_i2c_read_write.png" class="popup img-link "><img data-src="/assets/2023-09-01-digital-explorer-board/mcp_i2c_read_write.png" alt="mcp i2c read write" class="lazyload" data-proofer-ignore></a></p><h3 id="reading-lsm6ds3-accelerometer-values"><span class="mr-2">Reading LSM6DS3 Accelerometer Values</span><a href="#reading-lsm6ds3-accelerometer-values" class="anchor text-muted"><i class="fas fa-hashtag"></i></a></h3><p><strong>Do NOT have bPod connected for this demo</strong></p><p>By comparison to the MCP23017, the LSM6DS3 I2C read is a lot more straightforward.</p><ul><li>Talking to chip address <code class="language-plaintext highlighter-rouge">0x6A</code> (LSM), read address <code class="language-plaintext highlighter-rouge">0x28</code> (OUT_X_L_XL).<li>Taking to LSM, read 6 bytes from above address.<ul><li>Each X, Y, Z value is 16 bits (two bytes), so reading 6 bytes will read out all the data at once.</ul></ul><p><a href="/assets/2023-09-01-digital-explorer-board/lsm_i2c_read.png" class="popup img-link "><img data-src="/assets/2023-09-01-digital-explorer-board/lsm_i2c_read.png" alt="lsm i2c read" class="lazyload" data-proofer-ignore></a></p><h3 id="writing-data-stream-over-uart"><span class="mr-2">Writing Data Stream Over UART</span><a href="#writing-data-stream-over-uart" class="anchor text-muted"><i class="fas fa-hashtag"></i></a></h3><p><strong>Connect bPod for this demo, however you’ll have to comment out all the MCP23017 code otherwise it won’t run (lines 24-57, 179-182)</strong></p><p>Connect your bPod, and navigate to the <code class="language-plaintext highlighter-rouge">Tools -&gt; uartterm</code> page. With the setting of 115200/8N1, select <code class="language-plaintext highlighter-rouge">Terminal</code>.</p><p>You should now see <code class="language-plaintext highlighter-rouge">Hello World!</code> being printed on the screen.</p><p>From the logic analyser, you should also be able to decode this message.</p><p><a href="/assets/2023-09-01-digital-explorer-board/uart_hello_world.png" class="popup img-link "><img data-src="/assets/2023-09-01-digital-explorer-board/uart_hello_world.png" alt="uart hello world" class="lazyload" data-proofer-ignore></a></p><h3 id="controlling-mcp23017-from-bpod"><span class="mr-2">Controlling MCP23017 from bPod</span><a href="#controlling-mcp23017-from-bpod" class="anchor text-muted"><i class="fas fa-hashtag"></i></a></h3><p><strong>Connect bPod for this demo, however you’ll have to comment out all the MCP23017 code otherwise it won’t run (lines 24-57, 179-182)</strong></p><p>bPod has the ability to control the MCP23017 IO expander just like we do on the digital explorer board.</p><ul><li>Go to tools, and run <code class="language-plaintext highlighter-rouge">i2csniff</code> to check the address of your MCP23017. I’ll be in the range of <code class="language-plaintext highlighter-rouge">0x20 - 0x27</code>.<li>Then go to the <code class="language-plaintext highlighter-rouge">MCP23017</code> tab, set the address to the above.<li>Toggle <code class="language-plaintext highlighter-rouge">IOB0 - IOB3</code>, and you should see the LEDs toggle on and off.</ul><h3 id="controlling-ws2812b-addressable-leds"><span class="mr-2">Controlling WS2812B Addressable LEDs</span><a href="#controlling-ws2812b-addressable-leds" class="anchor text-muted"><i class="fas fa-hashtag"></i></a></h3><p><strong>Do NOT have bPod connected for this demo</strong></p><p><a href="/assets/2023-09-01-digital-explorer-board/led_la_conn.JPG" class="popup img-link "><img data-src="/assets/2023-09-01-digital-explorer-board/led_la_conn.JPG" alt="la connected to ws2812b" class="lazyload" data-proofer-ignore></a></p><p>WS2812B’s take a serial stream of packets into the first LED, and pass on packets 2…n to the next LED. This can be seen in the below stream, where three bytes make it to the first LED, two to the second LED, and one to the third (last) LED in the stream.</p><p><a href="/assets/2023-09-01-digital-explorer-board/ws2812.png" class="popup img-link "><img data-src="/assets/2023-09-01-digital-explorer-board/ws2812.png" alt="ws2812" class="lazyload" data-proofer-ignore></a></p></div><div class="post-tail-wrapper text-muted"><div class="post-tail-bottom d-flex justify-content-between align-items-center mt-3 pt-5 pb-2"><div class="license-wrapper"> This post is licensed under <a href="https://creativecommons.org/licenses/by/4.0/"> CC BY 4.0 </a> by the author.</div><div class="share-wrapper"> <span class="share-label text-muted mr-1">Share</span> <span class="share-icons"> <a href="https://twitter.com/intent/tweet?text=Digital%20Explorer%20Board%20-%20Josh%20Johnson&url=https%3A%2F%2Fjoshajohnson.github.io%2Fdigital-explorer-board%2F" data-toggle="tooltip" data-placement="top" title="Twitter" target="_blank" rel="noopener" aria-label="Twitter"> <i class="fa-fw fab fa-twitter"></i> </a> <a href="https://www.facebook.com/sharer/sharer.php?title=Digital%20Explorer%20Board%20-%20Josh%20Johnson&u=https%3A%2F%2Fjoshajohnson.github.io%2Fdigital-explorer-board%2F" data-toggle="tooltip" data-placement="top" title="Facebook" target="_blank" rel="noopener" aria-label="Facebook"> <i class="fa-fw fab fa-facebook-square"></i> </a> <a href="https://t.me/share/url?url=https%3A%2F%2Fjoshajohnson.github.io%2Fdigital-explorer-board%2F&text=Digital%20Explorer%20Board%20-%20Josh%20Johnson" data-toggle="tooltip" data-placement="top" title="Telegram" target="_blank" rel="noopener" aria-label="Telegram"> <i class="fa-fw fab fa-telegram"></i> </a> <i id="copy-link" class="fa-fw fas fa-link small" data-toggle="tooltip" data-placement="top" title="Copy link" data-title-succeed="Link copied successfully!"> </i> </span></div></div></div></div></div><div id="panel-wrapper" class="col-xl-3 pl-2 text-muted"><div class="access"><div id="access-lastmod" class="post"><div class="panel-heading">Recently Updated</div><ul class="post-content pl-0 pb-1 ml-1 mt-2"><li><a href="/bsidescbr23/">BSides Canberra 2023</a><li><a href="/bsidescbr23-workshop/">BSidesCBR23 Badge Add-on Workshop</a><li><a href="/digital-explorer-board/">Digital Explorer Board</a><li><a href="/sea-picro/">Sea-Picro</a><li><a href="/intro-keyboard/">Intro Keyboard Assembly Instructions</a></ul></div></div><div id="toc-wrapper" class="pl-0 pr-4 mb-5"><div class="panel-heading pl-3 pt-2 mb-2">Contents</div><nav id="toc"></nav></div><script src="https://cdn.jsdelivr.net/npm/tocbot@4.20.1/dist/tocbot.min.js"></script></div></div><div class="row"><div id="tail-wrapper" class="col-12 col-lg-11 col-xl-9 pl-3 pr-3 pr-xl-4 mt-5"><div id="related-posts" class="mb-2 mb-sm-4"><h3 class="pt-2 mb-4 ml-1" data-toc-skip>Further Reading</h3><div class="card-deck mb-4"><div class="card"> <a href="/bsidescbr23/"><div class="card-body"> <em class="small" data-ts="1693479600" data-df="ll" > Aug 31, 2023 </em><h3 class="pt-0 mt-1 mb-3" data-toc-skip>BSides Canberra 2023</h3><div class="text-muted small"><p> Hello! Welcome to the landing page for BSides Canberra 2023. Below are the links you’ve been searching for. Designing a Badge Add-on in KiCad SAO Connector Modification We unfortunately ran out...</p></div></div></a></div><div class="card"> <a href="/bsidescbr23-workshop/"><div class="card-body"> <em class="small" data-ts="1693477800" data-df="ll" > Aug 31, 2023 </em><h3 class="pt-0 mt-1 mb-3" data-toc-skip>BSidesCBR23 Badge Add-on Workshop</h3><div class="text-muted small"><p> Introduction The goal of today’s workshop is to design and assemble a printed circuit board (PCB) which takes the form of a magpie with a blinking eye. Once assembled, the add-on will plug into yo...</p></div></div></a></div><div class="card"> <a href="/soldering-equipment/"><div class="card-body"> <em class="small" data-ts="1693476000" data-df="ll" > Aug 31, 2023 </em><h3 class="pt-0 mt-1 mb-3" data-toc-skip>Soldering Equipment</h3><div class="text-muted small"><p> One of the common questions I get after running a workshop where soldering is involved is “I want to do this at home, what gear do you recommend?” This page is here to answer the question. Please ...</p></div></div></a></div></div></div><div class="post-navigation d-flex justify-content-between"> <a href="/soldering-equipment/" class="btn btn-outline-primary" prompt="Older"><p>Soldering Equipment</p></a> <a href="/bsidescbr23-workshop/" class="btn btn-outline-primary" prompt="Newer"><p>BSidesCBR23 Badge Add-on Workshop</p></a></div></div></div></div><div id="search-result-wrapper" class="d-flex justify-content-center unloaded"><div class="col-12 col-sm-11 post-content"><div id="search-hints"></div><div id="search-results" class="d-flex flex-wrap justify-content-center text-muted mt-3"></div></div></div></div><footer><div class="container pl-lg-4 pr-lg-4"><div class="d-flex justify-content-between align-items-center text-muted ml-md-3 mr-md-3"><div class="footer-left"><p class="mb-0"> © 2025 <a href="https://twitter.com/_joshajohnson">Josh Johnson</a>. <span data-toggle="tooltip" data-placement="top" title="Except where otherwise noted, the blog posts on this site are licensed under the Creative Commons Attribution 4.0 International (CC BY 4.0) License by the author.">Some rights reserved.</span></p></div><div class="footer-right"><p class="mb-0">Powered by <a href="https://jekyllrb.com" target="_blank" rel="noopener">Jekyll</a> with <a href="https://github.com/cotes2020/jekyll-theme-chirpy" target="_blank" rel="noopener">Chirpy</a> theme.</p></div></div></div></footer><div id="mask"></div><a id="back-to-top" href="#" aria-label="back-to-top" class="btn btn-lg btn-box-shadow" role="button"> <i class="fas fa-angle-up"></i> </a><div id="notification" class="toast" role="alert" aria-live="assertive" aria-atomic="true" data-animation="true" data-autohide="false"><div class="toast-header"> <button type="button" class="ml-2 ml-auto close" data-dismiss="toast" aria-label="Close"> <span aria-hidden="true">&times;</span> </button></div><div class="toast-body text-center pt-0"><p class="pl-2 pr-2 mb-3">A new version of content is available.</p><button type="button" class="btn btn-primary" aria-label="Update"> Update </button></div></div><script src="https://cdn.jsdelivr.net/npm/simple-jekyll-search@1.10.0/dest/simple-jekyll-search.min.js"></script> <script> SimpleJekyllSearch({ searchInput: document.getElementById('search-input'), resultsContainer: document.getElementById('search-results'), json: '/assets/js/data/search.json', searchResultTemplate: '<div class="pl-1 pr-1 pl-sm-2 pr-sm-2 pl-lg-4 pr-lg-4 pl-xl-0 pr-xl-0"> <a href="{url}">{title}</a><div class="post-meta d-flex flex-column flex-sm-row text-muted mt-1 mb-1"> {categories} {tags}</div><p>{snippet}</p></div>', noResultsText: '<p class="mt-5">Oops! No results found.</p>', templateMiddleware: function(prop, value, template) { if (prop === 'categories') { if (value === '') { return `${value}`; } else { return `<div class="mr-sm-4"><i class="far fa-folder fa-fw"></i>${value}</div>`; } } if (prop === 'tags') { if (value === '') { return `${value}`; } else { return `<div><i class="fa fa-tag fa-fw"></i>${value}</div>`; } } } }); </script> <script src="https://cdn.jsdelivr.net/combine/npm/magnific-popup@1/dist/jquery.magnific-popup.min.js,npm/lazysizes@5.3.2/lazysizes.min.js,npm/clipboard@2/dist/clipboard.min.js"></script> <script src="https://cdn.jsdelivr.net/combine/npm/dayjs@1/dayjs.min.js,npm/dayjs@1/locale/en.min.js,npm/dayjs@1/plugin/relativeTime.min.js,npm/dayjs@1/plugin/localizedFormat.min.js"></script> <script defer src="/assets/js/dist/post.min.js"></script> <script src="https://cdn.jsdelivr.net/npm/bootstrap@4/dist/js/bootstrap.bundle.min.js"></script> <script defer src="/app.js"></script>
